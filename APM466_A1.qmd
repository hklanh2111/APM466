---
title: "MAT1856/APM466 Assignment 1"
author: "Kieu Lan Anh Ha - 1010846925"
date: "February 7, 2026"
format:
  pdf:
    include-in-header: preamble.tex
execute:
  echo: false
  warning: false
  message: false
---

```{=latex}

\section*{\textbf{Fundamental Questions - 25 points}}

\begin{enumerate}
\item \hfill
  \begin{enumerate}
  \item
Governments issue bonds instead of printing money to prevent the risk of inflation, because increasing money supply can reduce the value of money. Issuing bonds allows governments to borrow money to finance government spending without immediately increasing money supply.

  \item
A flattening of the long-term part of a yield curve usually implies economic uncertainty. Investors may believe in slower economic growth or lower inflation in the future, so they buy more long-term bonds and push long-term yields down.

  \item
Quantitative easing is when a central bank buys large amounts of financial assets to lower long-term interest rates and boost the economy. The U.S. Federal Reserve used QE during and after COVID-19 by buying Treasury securities and mortgage-backed securities to stabilize financial markets and support recovery.
  \end{enumerate}

  \item
These are 10 bonds that I chose:
\begin{center}
\begin{tabular}{|l|c|c|l|c|}
\hline
\textbf{Bond} & \textbf{Coupon} & \textbf{Maturity} & \textbf{ISIN} & \textbf{Issue Date} \\
\hline
CAN 0.25 Mar 26 & 0.250\% & 03/01/2026 & CA135087L518 & 10/09/2020 \\
CAN 1.00 Sep 26 & 1.000\% & 09/01/2026 & CA135087L930 & 04/16/2021 \\
CAN 1.25 Mar 27 & 1.250\% & 03/01/2027 & CA135087M847 & 10/15/2021 \\
CAN 2.75 Sep 27 & 2.750\% & 09/01/2027 & CA135087N837 & 05/13/2022 \\
CAN 3.50 Mar 28 & 3.500\% & 03/01/2028 & CA135087P576 & 10/21/2022 \\
CAN 4.00 Mar 29 & 4.000\% & 03/01/2029 & CA135087Q988 & 10/13/2023 \\
CAN 3.50 Sep 29 & 3.500\% & 09/01/2029 & CA135087R895 & 04/08/2024 \\
CAN 2.75 Mar 30 & 2.750\% & 03/01/2030 & CA135087S471 & 10/03/2024 \\
CAN 2.75 Sep 30 & 2.750\% & 09/01/2030 & CA135087T388 & 04/10/2025 \\
CAN 2.75 Mar 31 & 2.750\% & 03/01/2031 & CA135087T792 & 10/02/2025 \\
\hline
\end{tabular}
\end{center}
All these 10 bonds have similar basic setup: they are all Government of Canada bonds with semi-annual coupon payments, which makes it easier to compare them and construct the yield, spot, and forward curves. Semi-annual coupons provide more cashflow points over time, which helps smooth the curve over the 0--5 year maturity range. They are also frequently traded, so prices are more reliable and consistent for plotting the curves.

\item
The eigenvectors of the covariance matrix describe the main directions the stochastic curve moves (e.g., shifting up/down, becoming steeper/flatter, or changing curvature). The eigenvalues tell us how important each pattern is, i.e., how much of the total variation is explained by each eigenvector. Therefore, the largest eigenvalue corresponds to the dominant movement pattern in the curve.
\end{enumerate}

\section*{\textbf{Empirical Questions - 75 points}}

\begin{enumerate}
\setcounter{enumi}{3}
\item \hfill
  \begin{enumerate}
  \item
On each day, we observe 10 yield-to-maturity (YTM) values, each corresponding to a different bond maturity. Because these maturities are unevenly spaced, we cannot directly draw a smooth yield curve over the 0--5 year range without estimating yields at intermediate terms.
To do this, we apply piecewise linear interpolation in maturity. Let $\{(\tau_j, y_j)\}_{j=1}^{10}$ denote the observed maturities (in years, ACT/365) and their continuously-compounded YTMs. For any maturity $\tau$ between two adjacent observed maturities $\tau_k$ and $\tau_{k+1}$, the yield is approximated by
\[
y(\tau)
=
y(\tau_k)
+
\frac{y(\tau_{k+1}) - y(\tau_k)}{\tau_{k+1} - \tau_k}
(\tau - \tau_k).
\]
This approach is straightforward and stable, and it is reasonable given that government bond yields typically vary smoothly with maturity over short intervals.
  \item
\textbf{Pseudo-code (bootstrap spot curve, ACT/365, semiannual coupons, continuous comp).} For each day $d$:
\begin{enumerate}
\item For each bond $j$, convert clean to dirty:
$AI_j \leftarrow (n_j/365)\,(F c_j)$ and $P^{dirty}_j \leftarrow P^{clean}_j + AI_j$.
\item For each bond $j$, generate coupon dates every 6 months to maturity; compute cashflows $CF_{j,i}$ (coupon, plus face at maturity) and times
$t_{j,i} \leftarrow \text{days}(d,\text{pay}_{j,i})/365$.
\item Sort bonds by increasing maturity time.
\item Initialize known spot set $\mathcal{S}\leftarrow \emptyset$.
\item For each bond $j$ in maturity order:
  \begin{enumerate}
  \item Let cashflows be $(t_1,CF_1),\ldots,(t_n,CF_n)$ with maturity $t_n$.
  \item Compute $PV_{known} \leftarrow \sum_{i=1}^{n-1} CF_i \exp(-r(t_i)\,t_i)$ using $r(t_i)$ from $\mathcal{S}$ (linearly interpolate if needed).
  \item Solve $D(t_n) \leftarrow (P^{dirty}_j - PV_{known})/CF_n$.
  \item Set $r(t_n) \leftarrow -\ln(D(t_n))/t_n$ and add $(t_n,r(t_n))$ to $\mathcal{S}$.
  \end{enumerate}
\item Interpolate $\mathcal{S}$ to obtain the spot curve over $t\in[1,5]$ (or spot points at $t=1,2,3,4,5$).
\item Plot the 1--5y spot curve for day $d$ and superimpose curves for all days.
\end{enumerate}

  \item
\textbf{Pseudo-code (1-year forward curve from spot curve, continuous comp).}
For each day $d$:
\begin{enumerate}
\item From the spot curve in (b), obtain $r(1),r(2),r(3),r(4),r(5)$ (interpolate if needed).
\item Compute 1-year forward rates using $f_{T,T+1} \leftarrow r(T+1)(T+1)-r(T)T$ for $T=1,2,3,4$:
$f_{1,2}, f_{2,3}, f_{3,4}, f_{4,5}$.
\item Store forward-curve points as $(2,f_{1,2}),(3,f_{2,3}),(4,f_{3,4}),(5,f_{4,5})$ (x-axis = end maturity).
\item Plot the forward curve for day $d$ and superimpose curves for all days.
\end{enumerate}
  \end{enumerate}

\item
The covariance matrix for the daily log-returns of yield:
\begin{figure}[h]
  \centering
  \includegraphics[width=0.5\textwidth]{Cov_yield.png}
  \caption{log-returns of yield}
\end{figure}
The covariance matrix for forward rates:
\begin{figure}[h]
  \centering
  \includegraphics[width=0.5\textwidth]{Cov-forward.png}
  \caption{log-returns of forward rate}
\end{figure}
\item
The eigenvalues and eigenvectors of both covariance matrices
\begin{figure}[H]
  \centering
  \includegraphics[width=0.5\textwidth]{Yield.png}
  \caption{the eigenvalues and eigenvectors of Yield covariance}
\end{figure}
\begin{figure}[H]
  \centering
  \includegraphics[width=0.5\textwidth]{forward.png}
  \caption{the eigenvalues and eigenvectors of Forward covariance}
\end{figure}
In both the yield and forward covariance matrices, the largest eigenvalue captures a dominant common movement in rates, while its associated eigenvector shows how that movement is distributed across maturities (1y–5y yields) and forward tenors (1y–1y to 1y–4y).
\end{enumerate}

\section*{\textbf{References and GitHub Link to Code}}
\begin{enumerate}
\item
Plot for 4(a)
\begin{center}
  \includegraphics[width=0.7\textwidth]{unnamed-chunk-2-1.png}
\end{center}

\item
Plot for 4(b)
\begin{center}
  \includegraphics[width=0.7\textwidth]{unnamed-chunk-3-1.png}
\end{center}

\item
Plot for 4(c)
\begin{center}
  \includegraphics[width=0.7\textwidth]{unnamed-chunk-4-1.png}
\end{center}

\item
\url{https://markets.businessinsider.com/bonds/finder?borrower=71&maturity=shortterm&yield=
&bondtype=2%2c3%2c4%2c16&coupon=&currency=184&rating=&country=19}
\item
\url{https://markets.businessinsider.com/bonds/finder?borrower=71&maturity=midterm&yield=
&bondtype=2%2c3%2c4%2c16&coupon=&currency=184&rating=&country=19}
\item
\url{https://github.com/hklanh2111/APM466}
\end{enumerate}
```
