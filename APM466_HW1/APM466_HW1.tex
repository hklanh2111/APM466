% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  letterpaper,
  DIV=11,
  numbers=noendperiod]{scrartcl}

\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else  
    % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
% Make \paragraph and \subparagraph free-standing
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{241,243,245}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.40,0.45,0.13}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.28,0.35,0.67}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.46,0.62}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.07,0.07,0.07}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother

\KOMAoption{captions}{tableheading}
\makeatletter
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother
\makeatletter
\@ifpackageloaded{tcolorbox}{}{\usepackage[skins,breakable]{tcolorbox}}
\makeatother
\makeatletter
\@ifundefined{shadecolor}{\definecolor{shadecolor}{rgb}{.97, .97, .97}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\makeatother
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={Untitled},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}

\title{Untitled}
\author{}
\date{}

\begin{document}
\maketitle
\ifdefined\Shaded\renewenvironment{Shaded}{\begin{tcolorbox}[breakable, sharp corners, boxrule=0pt, borderline west={3pt}{0pt}{shadecolor}, frame hidden, enhanced, interior hidden]}{\end{tcolorbox}}\fi

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
-- Attaching core tidyverse packages ------------------------ tidyverse 2.0.0 --
v dplyr     1.1.4     v readr     2.1.5
v forcats   1.0.0     v stringr   1.5.1
v ggplot2   3.5.0     v tibble    3.2.1
v lubridate 1.9.3     v tidyr     1.3.1
v purrr     1.0.2     
-- Conflicts ------------------------------------------ tidyverse_conflicts() --
x dplyr::filter() masks stats::filter()
x dplyr::lag()    masks stats::lag()
i Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(lubridate)}

\NormalTok{FACE }\OtherTok{\textless{}{-}} \DecValTok{100}

\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{\# Bonds (your 10)}
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\NormalTok{bonds }\OtherTok{\textless{}{-}}\NormalTok{ tibble}\SpecialCharTok{::}\FunctionTok{tribble}\NormalTok{(}
  \SpecialCharTok{\textasciitilde{}}\NormalTok{id, }\SpecialCharTok{\textasciitilde{}}\NormalTok{name,               }\SpecialCharTok{\textasciitilde{}}\NormalTok{coupon,  }\SpecialCharTok{\textasciitilde{}}\NormalTok{maturity,}
   \DecValTok{1}\NormalTok{, }\StringTok{"CAN 0.25 Mar 26"}\NormalTok{,    }\FloatTok{0.00250}\NormalTok{,  }\StringTok{"2026{-}03{-}01"}\NormalTok{,}
   \DecValTok{2}\NormalTok{, }\StringTok{"CAN 1.00 Sep 26"}\NormalTok{,    }\FloatTok{0.01000}\NormalTok{,  }\StringTok{"2026{-}09{-}01"}\NormalTok{,}
   \DecValTok{3}\NormalTok{, }\StringTok{"CAN 1.25 Mar 27"}\NormalTok{,    }\FloatTok{0.01250}\NormalTok{,  }\StringTok{"2027{-}03{-}01"}\NormalTok{,}
   \DecValTok{4}\NormalTok{, }\StringTok{"CAN 2.75 Sep 27"}\NormalTok{,    }\FloatTok{0.02750}\NormalTok{,  }\StringTok{"2027{-}09{-}01"}\NormalTok{,}
   \DecValTok{5}\NormalTok{, }\StringTok{"CAN 3.50 Mar 28"}\NormalTok{,    }\FloatTok{0.03500}\NormalTok{,  }\StringTok{"2028{-}03{-}01"}\NormalTok{,}
   \DecValTok{6}\NormalTok{, }\StringTok{"CAN 4.00 Mar 29"}\NormalTok{,    }\FloatTok{0.04000}\NormalTok{,  }\StringTok{"2029{-}03{-}01"}\NormalTok{,}
   \DecValTok{7}\NormalTok{, }\StringTok{"CAN 3.50 Sep 29"}\NormalTok{,    }\FloatTok{0.03500}\NormalTok{,  }\StringTok{"2029{-}09{-}01"}\NormalTok{,}
   \DecValTok{8}\NormalTok{, }\StringTok{"CAN 2.75 Mar 30"}\NormalTok{,    }\FloatTok{0.02750}\NormalTok{,  }\StringTok{"2030{-}03{-}01"}\NormalTok{,}
   \DecValTok{9}\NormalTok{, }\StringTok{"CAN 2.75 Sep 30"}\NormalTok{,    }\FloatTok{0.02750}\NormalTok{,  }\StringTok{"2030{-}09{-}01"}\NormalTok{,}
  \DecValTok{10}\NormalTok{, }\StringTok{"CAN 2.75 Mar 31"}\NormalTok{,    }\FloatTok{0.02750}\NormalTok{,  }\StringTok{"2031{-}03{-}01"}
\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{maturity =} \FunctionTok{as.Date}\NormalTok{(maturity))}

\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{\# Days (10)}
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\NormalTok{days }\OtherTok{\textless{}{-}} \FunctionTok{as.Date}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"2026{-}01{-}05"}\NormalTok{,}\StringTok{"2026{-}01{-}06"}\NormalTok{,}\StringTok{"2026{-}01{-}07"}\NormalTok{,}\StringTok{"2026{-}01{-}08"}\NormalTok{,}\StringTok{"2026{-}01{-}09"}\NormalTok{,}
                  \StringTok{"2026{-}01{-}12"}\NormalTok{,}\StringTok{"2026{-}01{-}13"}\NormalTok{,}\StringTok{"2026{-}01{-}14"}\NormalTok{,}\StringTok{"2026{-}01{-}15"}\NormalTok{,}\StringTok{"2026{-}01{-}16"}\NormalTok{))}

\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{\# Clean prices (10x10)}
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\NormalTok{clean\_mat }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}
  \FloatTok{99.70}\NormalTok{, }\FloatTok{99.71}\NormalTok{, }\FloatTok{99.71}\NormalTok{, }\FloatTok{99.72}\NormalTok{, }\FloatTok{99.73}\NormalTok{, }\FloatTok{99.74}\NormalTok{, }\FloatTok{99.74}\NormalTok{, }\FloatTok{99.75}\NormalTok{, }\FloatTok{99.76}\NormalTok{, }\FloatTok{99.77}\NormalTok{,}
  \FloatTok{99.145}\NormalTok{,}\FloatTok{99.145}\NormalTok{,}\FloatTok{99.165}\NormalTok{,}\FloatTok{99.160}\NormalTok{,}\FloatTok{99.190}\NormalTok{,}\FloatTok{99.180}\NormalTok{,}\FloatTok{99.190}\NormalTok{,}\FloatTok{99.200}\NormalTok{,}\FloatTok{99.210}\NormalTok{,}\FloatTok{99.220}\NormalTok{,}
  \FloatTok{98.600}\NormalTok{,}\FloatTok{98.630}\NormalTok{,}\FloatTok{98.660}\NormalTok{,}\FloatTok{98.670}\NormalTok{,}\FloatTok{98.670}\NormalTok{,}\FloatTok{98.670}\NormalTok{,}\FloatTok{98.680}\NormalTok{,}\FloatTok{98.670}\NormalTok{,}\FloatTok{98.730}\NormalTok{,}\FloatTok{98.720}\NormalTok{,}
  \FloatTok{100.22}\NormalTok{,}\FloatTok{100.30}\NormalTok{,}\FloatTok{100.28}\NormalTok{,}\FloatTok{100.31}\NormalTok{,}\FloatTok{100.30}\NormalTok{,}\FloatTok{100.32}\NormalTok{,}\FloatTok{100.30}\NormalTok{,}\FloatTok{100.31}\NormalTok{,}\FloatTok{100.35}\NormalTok{,}\FloatTok{100.37}\NormalTok{,}
  \FloatTok{101.73}\NormalTok{,}\FloatTok{101.78}\NormalTok{,}\FloatTok{101.78}\NormalTok{,}\FloatTok{101.80}\NormalTok{,}\FloatTok{101.79}\NormalTok{,}\FloatTok{101.81}\NormalTok{,}\FloatTok{101.78}\NormalTok{,}\FloatTok{101.81}\NormalTok{,}\FloatTok{101.84}\NormalTok{,}\FloatTok{101.83}\NormalTok{,}
  \FloatTok{103.63}\NormalTok{,}\FloatTok{103.70}\NormalTok{,}\FloatTok{103.71}\NormalTok{,}\FloatTok{103.74}\NormalTok{,}\FloatTok{103.73}\NormalTok{,}\FloatTok{103.76}\NormalTok{,}\FloatTok{103.72}\NormalTok{,}\FloatTok{103.76}\NormalTok{,}\FloatTok{103.79}\NormalTok{,}\FloatTok{103.78}\NormalTok{,}
  \FloatTok{102.22}\NormalTok{,}\FloatTok{102.33}\NormalTok{,}\FloatTok{102.37}\NormalTok{,}\FloatTok{102.34}\NormalTok{,}\FloatTok{102.31}\NormalTok{,}\FloatTok{102.35}\NormalTok{,}\FloatTok{102.29}\NormalTok{,}\FloatTok{102.33}\NormalTok{,}\FloatTok{102.43}\NormalTok{,}\FloatTok{102.42}\NormalTok{,}
  \FloatTok{99.493}\NormalTok{,}\FloatTok{99.423}\NormalTok{,}\FloatTok{99.563}\NormalTok{,}\FloatTok{99.498}\NormalTok{,}\FloatTok{99.580}\NormalTok{,}\FloatTok{99.528}\NormalTok{,}\FloatTok{99.503}\NormalTok{,}\FloatTok{99.658}\NormalTok{,}\FloatTok{99.663}\NormalTok{,}\FloatTok{99.613}\NormalTok{,}
  \FloatTok{99.165}\NormalTok{,}\FloatTok{99.085}\NormalTok{,}\FloatTok{99.245}\NormalTok{,}\FloatTok{99.170}\NormalTok{,}\FloatTok{99.255}\NormalTok{,}\FloatTok{99.210}\NormalTok{,}\FloatTok{99.185}\NormalTok{,}\FloatTok{99.355}\NormalTok{,}\FloatTok{99.365}\NormalTok{,}\FloatTok{99.315}\NormalTok{,}
  \FloatTok{98.813}\NormalTok{,}\FloatTok{98.723}\NormalTok{,}\FloatTok{98.888}\NormalTok{,}\FloatTok{98.823}\NormalTok{,}\FloatTok{98.913}\NormalTok{,}\FloatTok{98.850}\NormalTok{,}\FloatTok{98.838}\NormalTok{,}\FloatTok{99.033}\NormalTok{,}\FloatTok{99.043}\NormalTok{,}\FloatTok{98.968}
\NormalTok{), }\AttributeTok{nrow =} \DecValTok{10}\NormalTok{, }\AttributeTok{byrow =} \ConstantTok{TRUE}\NormalTok{)}

\FunctionTok{stopifnot}\NormalTok{(}\FunctionTok{nrow}\NormalTok{(clean\_mat) }\SpecialCharTok{==} \DecValTok{10}\NormalTok{, }\FunctionTok{ncol}\NormalTok{(clean\_mat) }\SpecialCharTok{==} \DecValTok{10}\NormalTok{)}

\FunctionTok{colnames}\NormalTok{(clean\_mat) }\OtherTok{\textless{}{-}} \FunctionTok{format}\NormalTok{(days, }\StringTok{"\%Y{-}\%m{-}\%d"}\NormalTok{)}
\FunctionTok{rownames}\NormalTok{(clean\_mat) }\OtherTok{\textless{}{-}} \FunctionTok{as.character}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{)}

\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{\# Long table: bond{-}day{-}clean}
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\NormalTok{prices }\OtherTok{\textless{}{-}} \FunctionTok{as\_tibble}\NormalTok{(clean\_mat, }\AttributeTok{rownames =} \StringTok{"id"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{id =} \FunctionTok{as.integer}\NormalTok{(id)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{id, }\AttributeTok{names\_to =} \StringTok{"settle\_chr"}\NormalTok{, }\AttributeTok{values\_to =} \StringTok{"clean"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{settle =} \FunctionTok{as.Date}\NormalTok{(settle\_chr)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{settle\_chr) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{left\_join}\NormalTok{(bonds, }\AttributeTok{by =} \StringTok{"id"}\NormalTok{)}

\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{\# Lecture simplifications: ACT/365, semiannual coupons}
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\NormalTok{last\_coupon\_date }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(settle, maturity) \{}
\NormalTok{  d }\OtherTok{\textless{}{-}}\NormalTok{ maturity}
  \ControlFlowTok{while}\NormalTok{ (d }\SpecialCharTok{\textgreater{}}\NormalTok{ settle) d }\OtherTok{\textless{}{-}}\NormalTok{ d }\SpecialCharTok{\%m{-}\%} \FunctionTok{months}\NormalTok{(}\DecValTok{6}\NormalTok{)}
\NormalTok{  d}
\NormalTok{\}}

\NormalTok{dirty\_price }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(clean, settle, maturity, coupon\_rate, }\AttributeTok{face =} \DecValTok{100}\NormalTok{) \{}
\NormalTok{  lc }\OtherTok{\textless{}{-}} \FunctionTok{last\_coupon\_date}\NormalTok{(settle, maturity)}
\NormalTok{  n\_days }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(settle }\SpecialCharTok{{-}}\NormalTok{ lc)}
\NormalTok{  AI }\OtherTok{\textless{}{-}}\NormalTok{ (n\_days }\SpecialCharTok{/} \DecValTok{365}\NormalTok{) }\SpecialCharTok{*}\NormalTok{ (face }\SpecialCharTok{*}\NormalTok{ coupon\_rate)}
\NormalTok{  clean }\SpecialCharTok{+}\NormalTok{ AI}
\NormalTok{\}}

\NormalTok{cashflows }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(settle, maturity, coupon\_rate, }\AttributeTok{face =} \DecValTok{100}\NormalTok{) \{}
\NormalTok{  d }\OtherTok{\textless{}{-}}\NormalTok{ maturity}
\NormalTok{  pay\_dates }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{()}
  \ControlFlowTok{while}\NormalTok{ (d }\SpecialCharTok{\textgreater{}}\NormalTok{ settle) \{}
\NormalTok{    pay\_dates }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(d, pay\_dates)}
\NormalTok{    d }\OtherTok{\textless{}{-}}\NormalTok{ d }\SpecialCharTok{\%m{-}\%} \FunctionTok{months}\NormalTok{(}\DecValTok{6}\NormalTok{)}
\NormalTok{  \}}
\NormalTok{  cpn\_amt }\OtherTok{\textless{}{-}}\NormalTok{ face }\SpecialCharTok{*}\NormalTok{ coupon\_rate }\SpecialCharTok{/} \DecValTok{2}
\NormalTok{  cf }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(cpn\_amt, }\FunctionTok{length}\NormalTok{(pay\_dates))}
\NormalTok{  cf[}\FunctionTok{length}\NormalTok{(cf)] }\OtherTok{\textless{}{-}}\NormalTok{ cf[}\FunctionTok{length}\NormalTok{(cf)] }\SpecialCharTok{+}\NormalTok{ face}
\NormalTok{  t }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(pay\_dates }\SpecialCharTok{{-}}\NormalTok{ settle) }\SpecialCharTok{/} \DecValTok{365}
  \FunctionTok{list}\NormalTok{(}\AttributeTok{t =}\NormalTok{ t, }\AttributeTok{cf =}\NormalTok{ cf)}
\NormalTok{\}}

\NormalTok{prices }\OtherTok{\textless{}{-}}\NormalTok{ prices }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{rowwise}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{dirty =} \FunctionTok{dirty\_price}\NormalTok{(clean, settle, maturity, coupon, FACE),}
    \AttributeTok{tau\_maturity =} \FunctionTok{as.numeric}\NormalTok{(maturity }\SpecialCharTok{{-}}\NormalTok{ settle) }\SpecialCharTok{/} \DecValTok{365}
\NormalTok{  ) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ungroup}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ============================================================}
\CommentTok{\# Q4(a): YTM (continuous comp) + superimposed 0–5y curves}
\CommentTok{\# Interpolation technique: linear interpolation between observed maturities}
\CommentTok{\# ============================================================}

\NormalTok{ytm\_continuous }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(dirty, settle, maturity, coupon\_rate, }\AttributeTok{face =} \DecValTok{100}\NormalTok{) \{}
\NormalTok{  cfobj }\OtherTok{\textless{}{-}} \FunctionTok{cashflows}\NormalTok{(settle, maturity, coupon\_rate, face)}
\NormalTok{  t }\OtherTok{\textless{}{-}}\NormalTok{ cfobj}\SpecialCharTok{$}\NormalTok{t}
\NormalTok{  cf }\OtherTok{\textless{}{-}}\NormalTok{ cfobj}\SpecialCharTok{$}\NormalTok{cf}
\NormalTok{  f }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(y) }\FunctionTok{sum}\NormalTok{(cf }\SpecialCharTok{*} \FunctionTok{exp}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{y }\SpecialCharTok{*}\NormalTok{ t)) }\SpecialCharTok{{-}}\NormalTok{ dirty}
  \FunctionTok{uniroot}\NormalTok{(f, }\AttributeTok{lower =} \SpecialCharTok{{-}}\FloatTok{0.05}\NormalTok{, }\AttributeTok{upper =} \FloatTok{0.25}\NormalTok{)}\SpecialCharTok{$}\NormalTok{root}
\NormalTok{\}}

\NormalTok{ytm\_tbl }\OtherTok{\textless{}{-}}\NormalTok{ prices }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{rowwise}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{tau =}\NormalTok{ tau\_maturity,}
    \AttributeTok{y\_cont =} \FunctionTok{ytm\_continuous}\NormalTok{(dirty, settle, maturity, coupon, FACE)}
\NormalTok{  ) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ungroup}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(tau }\SpecialCharTok{\textgreater{}=} \DecValTok{0}\NormalTok{, tau }\SpecialCharTok{\textless{}=} \DecValTok{5}\NormalTok{)}

\NormalTok{tau\_grid }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{5}\NormalTok{, }\AttributeTok{by =} \FloatTok{0.01}\NormalTok{)}

\NormalTok{ytm\_curve\_grid }\OtherTok{\textless{}{-}}\NormalTok{ ytm\_tbl }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(settle) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(tau, }\AttributeTok{.by\_group =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{reframe}\NormalTok{(\{}
\NormalTok{    x }\OtherTok{\textless{}{-}}\NormalTok{ tau}
\NormalTok{    y }\OtherTok{\textless{}{-}}\NormalTok{ y\_cont}
    \FunctionTok{tibble}\NormalTok{(}
      \AttributeTok{tau =}\NormalTok{ tau\_grid,}
      \AttributeTok{y\_grid =} \FunctionTok{approx}\NormalTok{(}\AttributeTok{x =}\NormalTok{ x, }\AttributeTok{y =}\NormalTok{ y, }\AttributeTok{xout =}\NormalTok{ tau\_grid,}
                      \AttributeTok{method =} \StringTok{"linear"}\NormalTok{, }\AttributeTok{rule =} \DecValTok{2}\NormalTok{)}\SpecialCharTok{$}\NormalTok{y}
\NormalTok{    )}
\NormalTok{  \})}

\FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}
    \AttributeTok{data =}\NormalTok{ ytm\_curve\_grid,}
    \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ tau, }\AttributeTok{y =} \DecValTok{100} \SpecialCharTok{*}\NormalTok{ y\_grid,}
        \AttributeTok{group =} \FunctionTok{factor}\NormalTok{(settle),}
        \AttributeTok{color =} \FunctionTok{factor}\NormalTok{(settle),}
        \AttributeTok{linetype =} \FunctionTok{factor}\NormalTok{(settle)),}
    \AttributeTok{linewidth =} \FloatTok{0.9}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}
    \AttributeTok{data =}\NormalTok{ ytm\_tbl,}
    \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ tau, }\AttributeTok{y =} \DecValTok{100} \SpecialCharTok{*}\NormalTok{ y\_cont, }\AttributeTok{color =} \FunctionTok{factor}\NormalTok{(settle)),}
    \AttributeTok{size =} \FloatTok{1.6}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{breaks =} \DecValTok{0}\SpecialCharTok{:}\DecValTok{5}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Yield Curves (Continuous{-}Compounded YTM), 0–5 Years"}\NormalTok{,}
    \AttributeTok{subtitle =} \StringTok{"10 days superimposed; linear interpolation between maturity points"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Term (years)"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"YTM (\%)"}\NormalTok{,}
    \AttributeTok{color =} \StringTok{"Day"}\NormalTok{,}
    \AttributeTok{linetype =} \StringTok{"Day"}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{(}\AttributeTok{base\_size =} \DecValTok{12}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
conversion failure on 'Yield Curves (Continuous-Compounded YTM), 0–5 Years' in
'mbcsToSbcs': dot substituted for <e2>
\end{verbatim}

\begin{verbatim}
Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
conversion failure on 'Yield Curves (Continuous-Compounded YTM), 0–5 Years' in
'mbcsToSbcs': dot substituted for <80>
\end{verbatim}

\begin{verbatim}
Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
conversion failure on 'Yield Curves (Continuous-Compounded YTM), 0–5 Years' in
'mbcsToSbcs': dot substituted for <93>
\end{verbatim}

\begin{verbatim}
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
conversion failure on 'Yield Curves (Continuous-Compounded YTM), 0–5 Years' in
'mbcsToSbcs': dot substituted for <e2>
\end{verbatim}

\begin{verbatim}
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
conversion failure on 'Yield Curves (Continuous-Compounded YTM), 0–5 Years' in
'mbcsToSbcs': dot substituted for <80>
\end{verbatim}

\begin{verbatim}
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
conversion failure on 'Yield Curves (Continuous-Compounded YTM), 0–5 Years' in
'mbcsToSbcs': dot substituted for <93>
\end{verbatim}

\begin{figure}[H]

{\centering \includegraphics{APM466_HW1_files/figure-pdf/unnamed-chunk-2-1.pdf}

}

\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ============================================================}
\CommentTok{\# ============================================================}
\CommentTok{\# CHUNK B (COMPLETE + FIXED) — SPOT CURVE r(t) with DOC{-}STYLE X{-}AXIS (MATURITY DATE)}
\CommentTok{\# 10 daily spot curves superimposed}
\CommentTok{\#}
\CommentTok{\# Does NOT assume tau\_years exists; computes it as (maturity {-} settle)/365}
\CommentTok{\# ============================================================}

\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(lubridate)}

\NormalTok{FACE }\OtherTok{\textless{}{-}} \DecValTok{100}

\CommentTok{\# {-}{-}{-} needs these from your setup: prices, cashflows() {-}{-}{-}}
\FunctionTok{stopifnot}\NormalTok{(}\FunctionTok{exists}\NormalTok{(}\StringTok{"prices"}\NormalTok{))}
\FunctionTok{stopifnot}\NormalTok{(}\FunctionTok{exists}\NormalTok{(}\StringTok{"cashflows"}\NormalTok{))}

\CommentTok{\# Ensure tau\_years exists (robust)}
\NormalTok{prices2 }\OtherTok{\textless{}{-}}\NormalTok{ prices }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{tau\_years =} \FunctionTok{as.numeric}\NormalTok{(maturity }\SpecialCharTok{{-}}\NormalTok{ settle) }\SpecialCharTok{/} \DecValTok{365}
\NormalTok{  )}

\CommentTok{\# {-}{-}{-} Bootstrap spot points for ONE day (continuous comp) {-}{-}{-}}
\NormalTok{bootstrap\_spot\_one\_day }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(day\_df) \{}

  \CommentTok{\# ensure tau\_years exists inside day\_df too}
\NormalTok{  day\_df }\OtherTok{\textless{}{-}}\NormalTok{ day\_df }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{mutate}\NormalTok{(}\AttributeTok{tau\_years =} \FunctionTok{as.numeric}\NormalTok{(maturity }\SpecialCharTok{{-}}\NormalTok{ settle) }\SpecialCharTok{/} \DecValTok{365}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{arrange}\NormalTok{(tau\_years)}

\NormalTok{  known\_t }\OtherTok{\textless{}{-}} \FunctionTok{numeric}\NormalTok{(}\DecValTok{0}\NormalTok{)}
\NormalTok{  known\_r }\OtherTok{\textless{}{-}} \FunctionTok{numeric}\NormalTok{(}\DecValTok{0}\NormalTok{)}

\NormalTok{  r\_at }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(t) \{}
    \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{length}\NormalTok{(known\_t) }\SpecialCharTok{==} \DecValTok{0}\NormalTok{) }\FunctionTok{stop}\NormalTok{(}\StringTok{"No known spot points yet."}\NormalTok{)}
    \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{any}\NormalTok{(}\FunctionTok{abs}\NormalTok{(t }\SpecialCharTok{{-}}\NormalTok{ known\_t) }\SpecialCharTok{\textless{}} \FloatTok{1e{-}12}\NormalTok{)) }\FunctionTok{return}\NormalTok{(known\_r[}\FunctionTok{which.min}\NormalTok{(}\FunctionTok{abs}\NormalTok{(t }\SpecialCharTok{{-}}\NormalTok{ known\_t))])}
    \ControlFlowTok{if}\NormalTok{ (t }\SpecialCharTok{\textless{}} \FunctionTok{min}\NormalTok{(known\_t)) }\FunctionTok{return}\NormalTok{(known\_r[}\FunctionTok{which.min}\NormalTok{(known\_t)])}
    \ControlFlowTok{if}\NormalTok{ (t }\SpecialCharTok{\textgreater{}} \FunctionTok{max}\NormalTok{(known\_t)) }\FunctionTok{return}\NormalTok{(known\_r[}\FunctionTok{which.max}\NormalTok{(known\_t)])}
    \FunctionTok{approx}\NormalTok{(}\AttributeTok{x =}\NormalTok{ known\_t, }\AttributeTok{y =}\NormalTok{ known\_r, }\AttributeTok{xout =}\NormalTok{ t, }\AttributeTok{method =} \StringTok{"linear"}\NormalTok{)}\SpecialCharTok{$}\NormalTok{y}
\NormalTok{  \}}

\NormalTok{  out }\OtherTok{\textless{}{-}} \FunctionTok{vector}\NormalTok{(}\StringTok{"list"}\NormalTok{, }\FunctionTok{nrow}\NormalTok{(day\_df))}

  \ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \FunctionTok{seq\_len}\NormalTok{(}\FunctionTok{nrow}\NormalTok{(day\_df))) \{}

\NormalTok{    settle   }\OtherTok{\textless{}{-}}\NormalTok{ day\_df}\SpecialCharTok{$}\NormalTok{settle[j]}
\NormalTok{    maturity }\OtherTok{\textless{}{-}}\NormalTok{ day\_df}\SpecialCharTok{$}\NormalTok{maturity[j]}
\NormalTok{    cpn      }\OtherTok{\textless{}{-}}\NormalTok{ day\_df}\SpecialCharTok{$}\NormalTok{coupon[j]}
\NormalTok{    Pdirty   }\OtherTok{\textless{}{-}}\NormalTok{ day\_df}\SpecialCharTok{$}\NormalTok{dirty[j]}

\NormalTok{    cfobj }\OtherTok{\textless{}{-}} \FunctionTok{cashflows}\NormalTok{(settle, maturity, cpn, FACE)}
\NormalTok{    t }\OtherTok{\textless{}{-}}\NormalTok{ cfobj}\SpecialCharTok{$}\NormalTok{t}
\NormalTok{    cf }\OtherTok{\textless{}{-}}\NormalTok{ cfobj}\SpecialCharTok{$}\NormalTok{cf}
\NormalTok{    n }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(t)}

\NormalTok{    PV\_known }\OtherTok{\textless{}{-}} \DecValTok{0}
    \ControlFlowTok{if}\NormalTok{ (n }\SpecialCharTok{\textgreater{}} \DecValTok{1}\NormalTok{) \{}
      \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{(n }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{)) \{}
\NormalTok{        ri }\OtherTok{\textless{}{-}} \FunctionTok{r\_at}\NormalTok{(t[i])}
\NormalTok{        PV\_known }\OtherTok{\textless{}{-}}\NormalTok{ PV\_known }\SpecialCharTok{+}\NormalTok{ cf[i] }\SpecialCharTok{*} \FunctionTok{exp}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{ri }\SpecialCharTok{*}\NormalTok{ t[i])}
\NormalTok{      \}}
\NormalTok{    \}}

\NormalTok{    Dn }\OtherTok{\textless{}{-}}\NormalTok{ (Pdirty }\SpecialCharTok{{-}}\NormalTok{ PV\_known) }\SpecialCharTok{/}\NormalTok{ cf[n]}
    \ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\FunctionTok{is.finite}\NormalTok{(Dn) }\SpecialCharTok{||}\NormalTok{ Dn }\SpecialCharTok{\textless{}=} \DecValTok{0}\NormalTok{) \{}
      \FunctionTok{stop}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"BOOTSTRAP FAILED: settle="}\NormalTok{, settle,}
                  \StringTok{" bond\_id="}\NormalTok{, day\_df}\SpecialCharTok{$}\NormalTok{id[j],}
                  \StringTok{" Dn="}\NormalTok{, }\FunctionTok{signif}\NormalTok{(Dn, }\DecValTok{8}\NormalTok{)))}
\NormalTok{    \}}

\NormalTok{    rn }\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\FunctionTok{log}\NormalTok{(Dn) }\SpecialCharTok{/}\NormalTok{ t[n]}

\NormalTok{    known\_t }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(known\_t, t[n])}
\NormalTok{    known\_r }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(known\_r, rn)}

\NormalTok{    out[[j]] }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{settle =}\NormalTok{ settle, }\AttributeTok{t\_maturity =}\NormalTok{ t[n], }\AttributeTok{r\_cont =}\NormalTok{ rn)}
\NormalTok{  \}}

  \FunctionTok{bind\_rows}\NormalTok{(out) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{arrange}\NormalTok{(t\_maturity)}
\NormalTok{\}}

\CommentTok{\# {-}{-}{-} Bootstrap ALL days (NO group\_modify) {-}{-}{-}}
\NormalTok{prices\_by\_day }\OtherTok{\textless{}{-}} \FunctionTok{split}\NormalTok{(prices2, prices2}\SpecialCharTok{$}\NormalTok{settle)}
\NormalTok{spot\_points }\OtherTok{\textless{}{-}}\NormalTok{ purrr}\SpecialCharTok{::}\FunctionTok{map\_dfr}\NormalTok{(prices\_by\_day, bootstrap\_spot\_one\_day)}

\CommentTok{\# {-}{-}{-} Attach maturity dates by rank within each settle day {-}{-}{-}}
\NormalTok{spot\_curve\_date }\OtherTok{\textless{}{-}}\NormalTok{ prices2 }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{distinct}\NormalTok{(settle, id, name, maturity, tau\_years) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(settle, tau\_years) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(settle) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{rank =} \FunctionTok{row\_number}\NormalTok{()) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ungroup}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{left\_join}\NormalTok{(}
\NormalTok{    spot\_points }\SpecialCharTok{\%\textgreater{}\%}
      \FunctionTok{group\_by}\NormalTok{(settle) }\SpecialCharTok{\%\textgreater{}\%}
      \FunctionTok{arrange}\NormalTok{(t\_maturity, }\AttributeTok{.by\_group =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
      \FunctionTok{mutate}\NormalTok{(}\AttributeTok{rank =} \FunctionTok{row\_number}\NormalTok{()) }\SpecialCharTok{\%\textgreater{}\%}
      \FunctionTok{ungroup}\NormalTok{(),}
    \AttributeTok{by =} \FunctionTok{c}\NormalTok{(}\StringTok{"settle"}\NormalTok{, }\StringTok{"rank"}\NormalTok{)}
\NormalTok{  ) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{settle\_f =} \FunctionTok{factor}\NormalTok{(settle))}

\CommentTok{\# {-}{-}{-} Plot: doc{-}style axis = maturity date {-}{-}{-}}
\FunctionTok{ggplot}\NormalTok{(}
\NormalTok{  spot\_curve\_date,}
  \FunctionTok{aes}\NormalTok{(}
    \AttributeTok{x =}\NormalTok{ maturity,}
    \AttributeTok{y =}\NormalTok{ r\_cont,}
    \AttributeTok{group =}\NormalTok{ settle\_f,}
    \AttributeTok{color =}\NormalTok{ settle\_f,}
    \AttributeTok{linetype =}\NormalTok{ settle\_f}
\NormalTok{  )}
\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{linewidth =} \FloatTok{0.9}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{size =} \FloatTok{1.8}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Spot rate r(t)"}\NormalTok{,}
    \AttributeTok{subtitle =} \StringTok{"Continuous{-}compounded spot rates bootstrapped from your 10 selected bonds"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Maturity date"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Spot rate (decimal)"}\NormalTok{,}
    \AttributeTok{color =} \StringTok{"Settlement date"}\NormalTok{,}
    \AttributeTok{linetype =} \StringTok{"Settlement date"}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{(}\AttributeTok{base\_size =} \DecValTok{12}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{APM466_HW1_files/figure-pdf/unnamed-chunk-3-1.pdf}

}

\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ============================================================}
\CommentTok{\# CHUNK C (COMPLETE + FIXED) — 1{-}YEAR FORWARD CURVE with DOC{-}STYLE X{-}AXIS (DATE)}
\CommentTok{\# Uses spot\_points created in CHUNK B.}
\CommentTok{\# ============================================================}

\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(lubridate)}

\FunctionTok{stopifnot}\NormalTok{(}\FunctionTok{exists}\NormalTok{(}\StringTok{"spot\_points"}\NormalTok{))}

\CommentTok{\# Interpolate spot r(1)..r(5) per day}
\NormalTok{spot\_int }\OtherTok{\textless{}{-}}\NormalTok{ spot\_points }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(settle) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(t\_maturity, }\AttributeTok{.by\_group =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{reframe}\NormalTok{(\{}
\NormalTok{    x }\OtherTok{\textless{}{-}}\NormalTok{ t\_maturity}
\NormalTok{    y }\OtherTok{\textless{}{-}}\NormalTok{ r\_cont}
    \FunctionTok{tibble}\NormalTok{(}
      \AttributeTok{T =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{,}
      \AttributeTok{rT =} \FunctionTok{approx}\NormalTok{(}\AttributeTok{x =}\NormalTok{ x, }\AttributeTok{y =}\NormalTok{ y, }\AttributeTok{xout =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{, }\AttributeTok{method =} \StringTok{"linear"}\NormalTok{, }\AttributeTok{rule =} \DecValTok{2}\NormalTok{)}\SpecialCharTok{$}\NormalTok{y}
\NormalTok{    )}
\NormalTok{  \})}

\CommentTok{\# Forward (continuous comp): f\_\{T{-}1,T\} = r(T)*T {-} r(T{-}1)*(T{-}1), T=2..5}
\NormalTok{fwd\_1yr }\OtherTok{\textless{}{-}}\NormalTok{ spot\_int }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(settle) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(T, }\AttributeTok{.by\_group =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{reframe}\NormalTok{(\{}
\NormalTok{    r }\OtherTok{\textless{}{-}}\NormalTok{ rT}
\NormalTok{    endT }\OtherTok{\textless{}{-}} \DecValTok{2}\SpecialCharTok{:}\DecValTok{5}
\NormalTok{    f }\OtherTok{\textless{}{-}}\NormalTok{ r[}\DecValTok{2}\SpecialCharTok{:}\DecValTok{5}\NormalTok{] }\SpecialCharTok{*}\NormalTok{ (}\DecValTok{2}\SpecialCharTok{:}\DecValTok{5}\NormalTok{) }\SpecialCharTok{{-}}\NormalTok{ r[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{4}\NormalTok{] }\SpecialCharTok{*}\NormalTok{ (}\DecValTok{1}\SpecialCharTok{:}\DecValTok{4}\NormalTok{)}
    \FunctionTok{tibble}\NormalTok{(}\AttributeTok{endT =}\NormalTok{ endT, }\AttributeTok{fwd =}\NormalTok{ f)}
\NormalTok{  \}) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ungroup}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{settle\_date =} \FunctionTok{as.Date}\NormalTok{(settle),}
    \AttributeTok{end\_date =}\NormalTok{ settle\_date }\SpecialCharTok{+} \FunctionTok{round}\NormalTok{(}\DecValTok{365} \SpecialCharTok{*}\NormalTok{ endT),  }\CommentTok{\# for plotting only}
    \AttributeTok{settle\_f =} \FunctionTok{factor}\NormalTok{(settle)}
\NormalTok{  )}

\FunctionTok{ggplot}\NormalTok{(}
\NormalTok{  fwd\_1yr,}
  \FunctionTok{aes}\NormalTok{(}
    \AttributeTok{x =}\NormalTok{ end\_date,}
    \AttributeTok{y =} \DecValTok{100} \SpecialCharTok{*}\NormalTok{ fwd,}
    \AttributeTok{group =}\NormalTok{ settle\_f,}
    \AttributeTok{color =}\NormalTok{ settle\_f,}
    \AttributeTok{linetype =}\NormalTok{ settle\_f}
\NormalTok{  )}
\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{linewidth =} \FloatTok{0.9}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{size =} \FloatTok{1.8}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"1{-}Year Forward Curve"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Year"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Forward rate (\%)"}\NormalTok{,}
    \AttributeTok{color =} \StringTok{"Settlement date"}\NormalTok{,}
    \AttributeTok{linetype =} \StringTok{"Settlement date"}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{(}\AttributeTok{base\_size =} \DecValTok{12}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{APM466_HW1_files/figure-pdf/unnamed-chunk-4-1.pdf}

}

\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(fwd\_1yr }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{arrange}\NormalTok{(settle, endT), }\AttributeTok{n =} \ConstantTok{Inf}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 40 x 6
   settle      endT    fwd settle_date end_date   settle_f  
   <date>     <int>  <dbl> <date>      <date>     <fct>     
 1 2026-01-05     2 0.0285 2026-01-05  2028-01-05 2026-01-05
 2 2026-01-05     3 0.0301 2026-01-05  2029-01-04 2026-01-05
 3 2026-01-05     4 0.0316 2026-01-05  2030-01-04 2026-01-05
 4 2026-01-05     5 0.0342 2026-01-05  2031-01-04 2026-01-05
 5 2026-01-06     2 0.0280 2026-01-06  2028-01-06 2026-01-06
 6 2026-01-06     3 0.0300 2026-01-06  2029-01-05 2026-01-06
 7 2026-01-06     4 0.0325 2026-01-06  2030-01-05 2026-01-06
 8 2026-01-06     5 0.0351 2026-01-06  2031-01-05 2026-01-06
 9 2026-01-07     2 0.0283 2026-01-07  2028-01-07 2026-01-07
10 2026-01-07     3 0.0299 2026-01-07  2029-01-06 2026-01-07
11 2026-01-07     4 0.0314 2026-01-07  2030-01-06 2026-01-07
12 2026-01-07     5 0.0345 2026-01-07  2031-01-06 2026-01-07
13 2026-01-08     2 0.0280 2026-01-08  2028-01-08 2026-01-08
14 2026-01-08     3 0.0298 2026-01-08  2029-01-07 2026-01-08
15 2026-01-08     4 0.0323 2026-01-08  2030-01-07 2026-01-08
16 2026-01-08     5 0.0347 2026-01-08  2031-01-07 2026-01-08
17 2026-01-09     2 0.0282 2026-01-09  2028-01-09 2026-01-09
18 2026-01-09     3 0.0298 2026-01-09  2029-01-08 2026-01-09
19 2026-01-09     4 0.0317 2026-01-09  2030-01-08 2026-01-09
20 2026-01-09     5 0.0342 2026-01-09  2031-01-08 2026-01-09
21 2026-01-12     2 0.0278 2026-01-12  2028-01-12 2026-01-12
22 2026-01-12     3 0.0297 2026-01-12  2029-01-11 2026-01-12
23 2026-01-12     4 0.0324 2026-01-12  2030-01-11 2026-01-12
24 2026-01-12     5 0.0346 2026-01-12  2031-01-11 2026-01-12
25 2026-01-13     2 0.0281 2026-01-13  2028-01-13 2026-01-13
26 2026-01-13     3 0.0298 2026-01-13  2029-01-12 2026-01-13
27 2026-01-13     4 0.0324 2026-01-13  2030-01-12 2026-01-13
28 2026-01-13     5 0.0344 2026-01-13  2031-01-12 2026-01-13
29 2026-01-14     2 0.0278 2026-01-14  2028-01-14 2026-01-14
30 2026-01-14     3 0.0296 2026-01-14  2029-01-13 2026-01-14
31 2026-01-14     4 0.0315 2026-01-14  2030-01-13 2026-01-14
32 2026-01-14     5 0.0337 2026-01-14  2031-01-13 2026-01-14
33 2026-01-15     2 0.0279 2026-01-15  2028-01-15 2026-01-15
34 2026-01-15     3 0.0296 2026-01-15  2029-01-14 2026-01-15
35 2026-01-15     4 0.0315 2026-01-15  2030-01-14 2026-01-15
36 2026-01-15     5 0.0339 2026-01-15  2031-01-14 2026-01-15
37 2026-01-16     2 0.0278 2026-01-16  2028-01-16 2026-01-16
38 2026-01-16     3 0.0297 2026-01-16  2029-01-15 2026-01-16
39 2026-01-16     4 0.0318 2026-01-16  2030-01-15 2026-01-16
40 2026-01-16     5 0.0343 2026-01-16  2031-01-15 2026-01-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ============================================================}
\CommentTok{\# Q5: Covariance matrices of daily LOG{-}RETURNS}
\CommentTok{\#   (A) YIELDS: r1..r5 = 1y..5y yields (NO spot rates)}
\CommentTok{\#   (B) FORWARDS: 1y{-}1y, 1y{-}2y, 1y{-}3y, 1y{-}4y}
\CommentTok{\#}
\CommentTok{\# Definition: X\_\{i,j\} = log( r\_\{i,j+1\} / r\_\{i,j\} ), j = 1..9}
\CommentTok{\# ============================================================}

\FunctionTok{library}\NormalTok{(tidyverse)}

\FunctionTok{stopifnot}\NormalTok{(}\FunctionTok{exists}\NormalTok{(}\StringTok{"ytm\_tbl"}\NormalTok{), }\FunctionTok{exists}\NormalTok{(}\StringTok{"fwd\_1yr"}\NormalTok{))}

\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{\# (A) Yield covariance (X1..X5)}
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\NormalTok{yield\_terms }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{5}

\CommentTok{\# get r\_i,j = yield at i{-}year term for each day (interpolate within day)}
\NormalTok{yield\_wide }\OtherTok{\textless{}{-}}\NormalTok{ ytm\_tbl }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(settle) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(tau, }\AttributeTok{.by\_group =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{reframe}\NormalTok{(\{}
\NormalTok{    x }\OtherTok{\textless{}{-}}\NormalTok{ tau}
\NormalTok{    y }\OtherTok{\textless{}{-}}\NormalTok{ y\_cont}
    \FunctionTok{tibble}\NormalTok{(}
      \AttributeTok{term =}\NormalTok{ yield\_terms,}
      \AttributeTok{r =} \FunctionTok{approx}\NormalTok{(}\AttributeTok{x =}\NormalTok{ x, }\AttributeTok{y =}\NormalTok{ y, }\AttributeTok{xout =}\NormalTok{ yield\_terms, }\AttributeTok{method =} \StringTok{"linear"}\NormalTok{, }\AttributeTok{rule =} \DecValTok{2}\NormalTok{)}\SpecialCharTok{$}\NormalTok{y}
\NormalTok{    )}
\NormalTok{  \}) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ungroup}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{var =} \FunctionTok{paste0}\NormalTok{(}\StringTok{"X"}\NormalTok{, term)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(settle, var, r) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_wider}\NormalTok{(}\AttributeTok{names\_from =}\NormalTok{ var, }\AttributeTok{values\_from =}\NormalTok{ r) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(settle)}

\CommentTok{\# compute log{-}returns X\_\{i,j\} = log(r\_\{i,j+1\}/r\_\{i,j\}) for j=1..9}
\NormalTok{yield\_logret }\OtherTok{\textless{}{-}}\NormalTok{ yield\_wide }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\FunctionTok{across}\NormalTok{(}\FunctionTok{starts\_with}\NormalTok{(}\StringTok{"X"}\NormalTok{), }\SpecialCharTok{\textasciitilde{}} \FunctionTok{log}\NormalTok{(}\FunctionTok{lead}\NormalTok{(.x) }\SpecialCharTok{/}\NormalTok{ .x))) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{slice}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\NormalTok{(}\FunctionTok{n}\NormalTok{() }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}         \CommentTok{\# keep j = 1..9}
  \FunctionTok{select}\NormalTok{(}\FunctionTok{starts\_with}\NormalTok{(}\StringTok{"X"}\NormalTok{))}

\NormalTok{Cov\_Yield }\OtherTok{\textless{}{-}} \FunctionTok{cov}\NormalTok{(}\FunctionTok{as.matrix}\NormalTok{(yield\_logret), }\AttributeTok{use =} \StringTok{"complete.obs"}\NormalTok{)}
\FunctionTok{rownames}\NormalTok{(Cov\_Yield) }\OtherTok{\textless{}{-}} \FunctionTok{colnames}\NormalTok{(Cov\_Yield) }\OtherTok{\textless{}{-}} \FunctionTok{paste0}\NormalTok{(}\StringTok{"X"}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{)}

\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{\# (B) Forward covariance (X1..X4 forwards)}
\CommentTok{\# X1 = 1y{-}1y, X2 = 1y{-}2y, X3 = 1y{-}3y, X4 = 1y{-}4y}
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\NormalTok{fwd\_wide }\OtherTok{\textless{}{-}}\NormalTok{ fwd\_1yr }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{var =} \FunctionTok{case\_when}\NormalTok{(}
\NormalTok{    endT }\SpecialCharTok{==} \DecValTok{2} \SpecialCharTok{\textasciitilde{}} \StringTok{"X1"}\NormalTok{,   }\CommentTok{\# 1y{-}1y}
\NormalTok{    endT }\SpecialCharTok{==} \DecValTok{3} \SpecialCharTok{\textasciitilde{}} \StringTok{"X2"}\NormalTok{,   }\CommentTok{\# 1y{-}2y}
\NormalTok{    endT }\SpecialCharTok{==} \DecValTok{4} \SpecialCharTok{\textasciitilde{}} \StringTok{"X3"}\NormalTok{,   }\CommentTok{\# 1y{-}3y}
\NormalTok{    endT }\SpecialCharTok{==} \DecValTok{5} \SpecialCharTok{\textasciitilde{}} \StringTok{"X4"}    \CommentTok{\# 1y{-}4y}
\NormalTok{  )) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(settle, var, }\AttributeTok{r =}\NormalTok{ fwd) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_wider}\NormalTok{(}\AttributeTok{names\_from =}\NormalTok{ var, }\AttributeTok{values\_from =}\NormalTok{ r) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(settle)}

\CommentTok{\# log{-}returns for forwards}
\NormalTok{fwd\_logret }\OtherTok{\textless{}{-}}\NormalTok{ fwd\_wide }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\FunctionTok{across}\NormalTok{(}\FunctionTok{starts\_with}\NormalTok{(}\StringTok{"X"}\NormalTok{), }\SpecialCharTok{\textasciitilde{}} \FunctionTok{log}\NormalTok{(}\FunctionTok{lead}\NormalTok{(.x) }\SpecialCharTok{/}\NormalTok{ .x))) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{slice}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\NormalTok{(}\FunctionTok{n}\NormalTok{() }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\FunctionTok{starts\_with}\NormalTok{(}\StringTok{"X"}\NormalTok{))}

\NormalTok{Cov\_Forward }\OtherTok{\textless{}{-}} \FunctionTok{cov}\NormalTok{(}\FunctionTok{as.matrix}\NormalTok{(fwd\_logret), }\AttributeTok{use =} \StringTok{"complete.obs"}\NormalTok{)}
\FunctionTok{rownames}\NormalTok{(Cov\_Forward) }\OtherTok{\textless{}{-}} \FunctionTok{colnames}\NormalTok{(Cov\_Forward) }\OtherTok{\textless{}{-}} \FunctionTok{paste0}\NormalTok{(}\StringTok{"X"}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{4}\NormalTok{)}

\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{\# Print results}
\CommentTok{\# {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{=== Covariance matrix: daily log{-}returns of YIELDS (X1..X5 = 1y..5y) ===}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}

=== Covariance matrix: daily log-returns of YIELDS (X1..X5 = 1y..5y) ===
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(Cov\_Yield)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
             X1            X2            X3            X4            X5
X1 5.462531e-05  4.231525e-06  1.534532e-06  1.335811e-05  1.079575e-05
X2 4.231525e-06  2.767099e-05  2.000900e-05 -1.485856e-06 -1.245030e-05
X3 1.534532e-06  2.000900e-05  1.576227e-05  3.572018e-06 -3.022616e-06
X4 1.335811e-05 -1.485856e-06  3.572018e-06  3.652394e-05  4.476728e-05
X5 1.079575e-05 -1.245030e-05 -3.022616e-06  4.476728e-05  5.962618e-05
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{=== Covariance matrix: daily log{-}returns of FORWARDS (X1..X4 = 1y{-}1y..1y{-}4y) ===}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}

=== Covariance matrix: daily log-returns of FORWARDS (X1..X4 = 1y-1y..1y-4y) ===
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(Cov\_Forward)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
              X1           X2            X3            X4
X1  1.252076e-04 1.475132e-05 -1.518390e-04 -9.725355e-05
X2  1.475132e-05 1.167729e-05  2.535662e-05  1.692211e-05
X3 -1.518390e-04 2.535662e-05  5.543492e-04  3.361380e-04
X4 -9.725355e-05 1.692211e-05  3.361380e-04  2.487606e-04
\end{verbatim}

The eigenvalues and eigenvectors for the log-returns of yield covariance
matrix are:

{[}

\begin{array}{c|ccccc}
\lambda & 1.014944e-04 & 5.411635e-05 & 3.814688e-05 & 3.285767e-07 & 1.224844e-07 \\
\hline
\vec{v} &
\begin{array}{ccccc}
-0.3227 &  0.7948 &  0.5087 &  0.0679 &  0.0288 \\
 0.1247 &  0.4682 & -0.6087 & -0.4928 &  0.3898 \\
 0.0253 &  0.2947 & -0.5322 &  0.7576 & -0.2352 \\
-0.5772 & -0.0109 & -0.2612 & -0.3708 & -0.6790 \\
-0.7393 & -0.2494 & -0.1390 &  0.2027 &  0.5752
\end{array}
\end{array}

{]}

\textit{Table: eigen of yield rate}

The eigenvalues and eigenvectors for the log-returns of forward
covariance matrix are:

{[}

\begin{array}{c|cccc}
\lambda & 8.185631e-04 & 8.477887e-05 & 3.231839e-05 & 4.334337e-06 \\
\hline
\vec{v} &
\begin{array}{cccc}
-0.2509 &  0.9302 & -0.0132 &  0.2677 \\
 0.0320 &  0.2844 &  0.0095 & -0.9581 \\
 0.8135 &  0.1893 & -0.5443 &  0.0780 \\
 0.5237 &  0.1343 &  0.8387 &  0.0656
\end{array}
\end{array}

{]}

\textit{Table: eigen of forward rate}



\end{document}
